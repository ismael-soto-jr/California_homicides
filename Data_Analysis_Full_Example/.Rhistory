title = "New York Murder Rate 2019 vs. 2020",
subtitle = "By Age Group, Race, Gender"
) +
scale_color_brewer(palette = "Set1") +
theme_minimal() +
theme(axis.text.y = element_text(size=5, face = "bold"),
axis.text.x = element_text(size=7, face = "bold"),
plot.background = element_rect(fill = "white"))
all_ny
ggsave(file = "NY.png", all_ny, height = 8, width=6.5)
all_ill <- filter(summary_final, YEAR %in% c(2019, 2020) & STATEFIP == 17) %>%
ggplot(., mapping = aes(x = reorder(age_group, desc(age_group)), y = murder_rate)) +
geom_line(size = .2) + geom_point(aes(color = YEAR), alpha = .8, size = .9) + facet_wrap( ~race_new + male, ncol = 2) +
coord_flip() +
labs(
x = "Age Group",
y = "Murders per 100,000",
title = "Illinois Murder Rate 2019 vs. 2020",
subtitle = "By Age Group, Race, Gender"
) +
scale_color_brewer(palette = "Set1") +
theme_minimal() +
theme(axis.text.y = element_text(size=5, face = "bold"),
axis.text.x = element_text(size=7, face = "bold"),
plot.background = element_rect(fill = "white"))
all_ill
ggsave(file = "ill.png", all_ill, height = 8, width=6.5)
ggsave(file = "ill.png", all_ill, height = 8, width=6.5)
all_tx <- filter(summary_final, YEAR %in% c(2019, 2020) & STATEFIP == 48) %>%
ggplot(., mapping = aes(x = reorder(age_group, desc(age_group)), y = murder_rate)) +
geom_line(size = .2) + geom_point(aes(color = YEAR), alpha = .8, size = .9) + facet_wrap( ~race_new + male, ncol = 2) +
coord_flip() +
labs(
x = "Age Group",
y = "Murders per 100,000",
title = "Texas Murder Rate 2019 vs. 2020",
subtitle = "By Age Group, Race, Gender"
) +
scale_color_brewer(palette = "Set1") +
theme_minimal() +
theme(axis.text.y = element_text(size=5, face = "bold"),
axis.text.x = element_text(size=7, face = "bold"),
plot.background = element_rect(fill = "white"))
all_tx
ggsave(file = "tx.png", all_tx, height = 8, width=6.5)
knitr::opts_chunk$set(echo = TRUE)
library(haven)
library(readr)
library(tidyverse)
library(dplyr)
library(here)
library(table1)
library(pastecs)
library(furniture)
library(gridExtra)
library(tidycensus)
library(purrr)
library(ipumsr)
library(doBy)
library(skimr)
library(stringr)
library(modelr)
library(ggrepel)
library(plotly)
library(hrbrthemes)
library(viridis)
library(scales)
library(snakecase)
summary_final <- read_rds("murder_rates.rds")
males <- filter(summary_final, YEAR %in% c(2019,2020) & male == 1) %>% ggplot(., mapping =aes(x=reorder(age_group, desc(age_group)), y=murder_rate)) +
geom_line() +geom_point(aes(color=YEAR)) +facet_wrap(~race_new) +coord_flip()
females <- filter(summary_final, YEAR %in% c(2019,2020) & male == 0) %>% ggplot(., mapping =aes(x=reorder(age_group, desc(age_group)), y=murder_rate)) +
geom_line() +geom_point(aes(color=YEAR)) +facet_wrap(~race_new) +coord_flip()
all <-
filter(summary_final, YEAR %in% c(2019, 2020) & STATEFIP == 6) %>%
ggplot(., mapping = aes(x = reorder(age_group, desc(age_group)), y = murder_rate)) +
geom_line(size = .2) + geom_point(aes(color = YEAR), alpha = .8, size = .9) + facet_wrap( ~race_new + male, ncol = 2) +
coord_flip() +
labs(
x = "Age Group",
y = "Murders per 100,000",
title = "California Murder Rate 2019 vs. 2020",
subtitle = "By Age Group, Race, Gender"
) +
scale_color_brewer(palette = "Set1") +
theme_minimal() +
theme(axis.text.y = element_text(size=5, face = "bold"),
axis.text.x = element_text(size=7, face = "bold"),
plot.background = element_rect(fill = "white"))
all
ggsave(file = "CA.png", all, height = 8, width=6.5)
all_ny <- filter(summary_final, YEAR %in% c(2019, 2020) & STATEFIP == 36) %>%
ggplot(., mapping = aes(x = reorder(age_group, desc(age_group)), y = murder_rate)) +
geom_line(size = .2) + geom_point(aes(color = YEAR), alpha = .8, size = .9) + facet_wrap( ~race_new + male, ncol = 2) +
coord_flip() +
labs(
x = "Age Group",
y = "Murders per 100,000",
title = "New York Murder Rate 2019 vs. 2020",
subtitle = "By Age Group, Race, Gender"
) +
scale_color_brewer(palette = "Set1") +
theme_minimal() +
theme(axis.text.y = element_text(size=5, face = "bold"),
axis.text.x = element_text(size=7, face = "bold"),
plot.background = element_rect(fill = "white"))
all_ny
ggsave(file = "NY.png", all_ny, height = 8, width=6.5)
all_ill <- filter(summary_final, YEAR %in% c(2019, 2020) & STATEFIP == 17) %>%
ggplot(., mapping = aes(x = reorder(age_group, desc(age_group)), y = murder_rate)) +
geom_line(size = .2) + geom_point(aes(color = YEAR), alpha = .8, size = .9) + facet_wrap( ~race_new + male, ncol = 2) +
coord_flip() +
labs(
x = "Age Group",
y = "Murders per 100,000",
title = "Illinois Murder Rate 2019 vs. 2020",
subtitle = "By Age Group, Race, Gender"
) +
scale_color_brewer(palette = "Set1") +
theme_minimal() +
theme(axis.text.y = element_text(size=5, face = "bold"),
axis.text.x = element_text(size=7, face = "bold"),
plot.background = element_rect(fill = "white"))
all_ill
ggsave(file = "ill.png", all_ill, height = 8, width=6.5)
all_tx <- filter(summary_final, YEAR %in% c(2019, 2020) & STATEFIP == 48) %>%
ggplot(., mapping = aes(x = reorder(age_group, desc(age_group)), y = murder_rate)) +
geom_line(size = .2) + geom_point(aes(color = YEAR), alpha = .8, size = .9) + facet_wrap( ~race_new + male, ncol = 2) +
coord_flip() +
labs(
x = "Age Group",
y = "Murders per 100,000",
title = "Texas Murder Rate 2019 vs. 2020",
subtitle = "By Age Group, Race, Gender"
) +
scale_color_brewer(palette = "Set1") +
theme_minimal() +
theme(axis.text.y = element_text(size=5, face = "bold"),
axis.text.x = element_text(size=7, face = "bold"),
plot.background = element_rect(fill = "white"))
all_tx
ggsave(file = "tx.png", all_tx, height = 8, width=6.5)
all_flr <- filter(summary_final, YEAR %in% c(2019,2020) & STATEFIP == 12) %>%
ggplot(., mapping =aes(x=reorder(age_group, desc(age_group)), y=murder_rate)) +
geom_line() +geom_point(aes(color=YEAR), alpha=.8) +facet_wrap(~race_new + male, ncol =2) +coord_flip() +
labs(x = "Age Group", y = "Murders per 100,000")
ggsave(file = "all_flr.png", all_flr, height = 8, width=6.5)
all_pen <- filter(summary_final, YEAR %in% c(2019,2020) & STATEFIP == 42) %>%
ggplot(., mapping =aes(x=reorder(age_group, desc(age_group)), y=murder_rate)) +
geom_line() +geom_point(aes(color=YEAR), alpha=.8) +facet_wrap(~race_new + male, ncol =2) +coord_flip() +
labs(x = "Age Group", y = "Murders per 100,000")
ggsave(file = "all_pen.png", all_pen, height = 8, width=6.5)
all_ga <- filter(summary_final, YEAR %in% c(2019,2020) & STATEFIP == 13) %>%
ggplot(., mapping =aes(x=reorder(age_group, desc(age_group)), y=murder_rate)) +
geom_line() +geom_point(aes(color=YEAR), alpha=.8) +facet_wrap(~race_new + male, ncol =2) +coord_flip() +
labs(x = "Age Group", y = "Murders per 100,000")
ggsave(file = "all_ga.png", all_ga, height = 8, width=6.5)
all_oh <- filter(summary_final, YEAR %in% c(2019,2020) & STATEFIP == 39) %>%
ggplot(., mapping =aes(x=reorder(age_group, desc(age_group)), y=murder_rate)) +
geom_line() +geom_point(aes(color=YEAR), alpha=.8) +facet_wrap(~race_new + male, ncol =2) +coord_flip() +
labs(x = "Age Group", y = "Murders per 100,000")
ggsave(file = "all_oh.png", all_oh, height = 8, width=6.5)
all_nc <- filter(summary_final, YEAR %in% c(2019,2020) & STATEFIP == 37) %>%
ggplot(., mapping =aes(x=reorder(age_group, desc(age_group)), y=murder_rate)) +
geom_line() +geom_point(aes(color=YEAR), alpha=.8) +facet_wrap(~race_new + male, ncol =2) +coord_flip() +
labs(x = "Age Group", y = "Murders per 100,000")
ggsave(file = "all_nc.png", all_nc, height = 8, width=6.5)
all_mi <- filter(summary_final, YEAR %in% c(2019,2020) & STATEFIP == 26) %>%
ggplot(., mapping =aes(x=reorder(age_group, desc(age_group)), y=murder_rate)) +
geom_line() +geom_point(aes(color=YEAR), alpha=.8) +facet_wrap(~race_new + male, ncol =2) +coord_flip() +
labs(x = "Age Group", y = "Murders per 100,000")
ggsave(file = "all_mi.png", all_mi, height = 8, width=6.5)
all_dc <- filter(summary_final, YEAR %in% c(2019,2020) & STATEFIP == 11) %>%
ggplot(., mapping =aes(x=reorder(age_group, desc(age_group)), y=murder_rate)) +
geom_line() +geom_point(aes(color=YEAR), alpha=.8) +facet_wrap(~race_new + male, ncol =2) +coord_flip() +
labs(x = "Age Group", y = "Murders per 100,000")
ggsave(file = "all_dc.png", all_dc, height = 8, width=6.5)
all_vt <- filter(summary_final, YEAR %in% c(2019,2020) & STATEFIP == 50) %>%
ggplot(., mapping =aes(x=reorder(age_group, desc(age_group)), y=murder_rate)) +
geom_line() +geom_point(aes(color=YEAR), alpha=.8) +facet_wrap(~race_new + male, ncol =2) +coord_flip() +
labs(x = "Age Group", y = "Murders per 100,000")
ggsave(file = "all_vt.png", all_vt, height = 8, width=6.5)
comparison <- summary_final %>%
select(STATEFIP,YEAR, murder_rate, murder.sum, race_new,age_group, male) %>%
group_by(STATEFIP, race_new,age_group) %>%
pivot_wider(names_from = "YEAR",
values_from = c(murder_rate,murder.sum))  %>%
ungroup()
skim(comparison)
comparison %>%
count(is.na(murder_rate_2020))
comparison <- comparison %>%
mutate_at(vars(murder_rate_2019,murder_rate_2020), funs(round(.,2))) %>%
mutate(change = murder_rate_2020 - murder_rate_2019,
total = murder.sum_2019 + murder.sum_2020)
#comparison$"2019" <- as.numeric(comparison$"2019")
#comparison$"2020" <- as.numeric(comparison$"2020")
library(ggrepel)
plot <-comparison %>%
filter(male=="Male" & (STATEFIP==6 | STATEFIP==17)) %>%
mutate(state= ifelse(STATEFIP==6,"California","Illinois")) %>%
ggplot(aes(x=murder_rate_2019, y=murder_rate_2020, group = state, color = race_new)) +
geom_jitter( size = 1) +
#geom_smooth(method = lm, se =TRUE) +
geom_abline(intercept = 0, slope = 1, size = .2, color = 'red') +
# geom_text_repel(data= subset(comparison, change>500),
#                 mapping = aes(label=STATEFIP),
#                 size = 2.5,
#                 min.segment.length = 0,
#                 seed = 42,
#                 box.padding = .5,
#                 max.overlaps = Inf,
#                 arrow = arrow(length = unit(0.010, "npc")),
#                 nudge_x = .2,
#                 nudge_y = -.2,
#                 color = "grey50")+
#
#scale_x_continuous(expand=c(0.02,0),labels = scales::label_number(accuracy = .01), limits = c(0,6.25), breaks = c(0,2.5,5.0), minor_breaks = c(1.25,3.75,6.25)) +
#scale_y_continuous(expand = c(0,0),labels = scales::label_number(accuracy = .01)) +
labs(title = "Yearly Murders per 100K Residents, 2019 to 2020",
subtitle = "CA & IL Males by Age Groups & Ethnicity",
#caption = "Labeled = Counties with Rate Change > 1.5",
x ="Murder Rate 2019",
y = "Murder Rate 2020")
ggplotly(plot)
w <- comparison %>%
filter(STATEFIP == 6 | STATEFIP==17 | STATEFIP==48) %>%
mutate(state= ifelse(STATEFIP==6,"California",
ifelse(STATEFIP==17,"Illinois","Texas"))) %>%
ggplot(aes(x = murder_rate_2019, y = murder_rate_2020, color = age_group,group = state)) +
geom_jitter(size = 1, alpha = 0.8) +
geom_abline(intercept = 0, slope = 1, size = .09, color = 'red') +
#scale_x_log10() +
labs(x = "2019",
y = "2020",
title = "Murder Rates") +
facet_wrap(~ race_new+male, ncol = 2)
w
ggplotly(w)
comparison$net_change <-  ifelse(comparison$change < 0, "decreased", "increased")
comparison <- comparison[order(comparison$change), ]
comparison %>%
filter(STATEFIP==6 & race_new=="Black" & male=="Male") %>%
ggplot(aes(x=`age_group`, y=change, label=change)) +
geom_bar(stat='identity', aes(fill=net_change), width=.5)  +
# scale_fill_manual(name="Net Change",
#                   labels = c("Increased", "Decreased"),
#                   values = c("Increased"="#00ba38", "Decreased"="#f8766d")) +
labs(subtitle="Normalised mileage from 'mtcars'",
title= "Diverging Bars") +
#facet_wrap(~ age_group+male, ncol = 2) +
coord_flip()
dplot <- comparison %>%
filter(STATEFIP==6) %>%
ggplot(aes(x=`age_group`, y=change, label=change)) +
geom_bar(stat='identity', aes(fill=race_new), position = "dodge")  +
xlab("Age Group") +
ylab("Change in Murders per 100K, 2019 to 2020") +
scale_fill_brewer(palette = "Set1") +
labs(subtitle="By Age Group-Gender-Race",
title= "CA Change in Murders per 100K Residents, 2019 to 2020") +
guides(fill=guide_legend(title = "Race")) +
facet_wrap(~ male, ncol = 2) +
coord_flip()
dplot
ggsave(file = "dplot.png", dplot, height = 11, width=8.5)
dplot_IL <- comparison %>%
filter(STATEFIP==17) %>%
ggplot(aes(x=`age_group`, y=change, label=change)) +
geom_bar(stat='identity', aes(fill=race_new), position = "dodge")  +
xlab("Age Group") +
ylab("Change in Murders per 100K, 2019 to 2020") +
scale_fill_brewer(palette = "Set1") +
labs(subtitle="By Age Group-Gender-Race",
title= "IL Change in Murders per 100K Residents, 2019 to 2020") +
guides(fill=guide_legend(title = "Race")) +
facet_wrap(~ male, ncol = 2) +
coord_flip()
dplot_IL
ggsave(file = "dplot_IL.png", dplot_IL, height = 11, width=8.5)
dplot_MI <- comparison %>%
filter(STATEFIP==26) %>%
ggplot(aes(x=`age_group`, y=change, label=change)) +
geom_bar(stat='identity', aes(fill=race_new), position = "dodge")  +
xlab("Age Group") +
ylab("Change in Murders per 100K, 2019 to 2020") +
scale_fill_brewer(palette = "Set1") +
labs(subtitle="By Age Group-Gender-Race",
title= "MI Change in Murders per 100K Residents, 2019 to 2020") +
guides(fill=guide_legend(title = "Race")) +
facet_wrap(~ male, ncol = 2) +
coord_flip()
dplot_MI
ggsave(file = "dplot_MI.png", dplot_MI, height = 11, width=8.5)
comparison %>%
filter(STATEFIP==6 & male=="Male") %>%
ggplot(aes(x=`age_group`, y=change, label=change)) +
geom_bar(stat='identity', aes(fill=net_change), width=.5)  +
# scale_fill_manual(name="Net Change",
#                   labels = c("Increased", "Decreased"),
#                   values = c("Increased"="#00ba38", "Decreased"="#f8766d")) +
labs(subtitle="2019 vs. 2020",
title= "Murder Rate Change Males") +
facet_wrap(~ race_new, ncol = 2) +
coord_flip()
comparison %>%
filter(STATEFIP==48 & male=="Male") %>%
ggplot(aes(x=`age_group`, y=change, label=change)) +
geom_bar(stat='identity', aes(fill=net_change), width=.5)  +
# scale_fill_manual(name="Net Change",
#                   labels = c("Increased", "Decreased"),
#                   values = c("Increased"="#00ba38", "Decreased"="#f8766d")) +
labs(subtitle="2019 vs. 2020",
title= "Murder Rate Change Males") +
facet_wrap(~ race_new, ncol = 2) +
coord_flip()
comparison %>%
filter(STATEFIP==22 & male=="Male") %>%
ggplot(aes(x=`age_group`, y=change, label=change)) +
geom_bar(stat='identity', aes(fill=net_change), width=.5)  +
# scale_fill_manual(name="Net Change",
#                   labels = c("Increased", "Decreased"),
#                   values = c("Increased"="#00ba38", "Decreased"="#f8766d")) +
labs(subtitle="2019 vs. 2020",
title= "Murder Rate Change Males") +
facet_wrap(~ race_new, ncol = 2) +
coord_flip()
homicide_nat <- read_rds("homicide_nat.rds")
males <- filter(homicide_nat, YEAR %in% c(2019,2020) & male == 1) %>% ggplot(., mapping =aes(x=reorder(age_group, desc(age_group)), y=murder_rate)) +
geom_line() +geom_point(aes(color=YEAR)) +facet_wrap(~race_new) +coord_flip()
females <- filter(homicide_nat, YEAR %in% c(2019,2020) & male == 0) %>% ggplot(., mapping =aes(x=reorder(age_group, desc(age_group)), y=murder_rate)) +
geom_line() +geom_point(aes(color=YEAR)) +facet_wrap(~race_new) +coord_flip()
national <- filter(homicide_nat, YEAR %in% c(2019,2020)) %>%
ggplot(., mapping =aes(x=reorder(age_group, desc(age_group)), y=murder_rate)) +
geom_line() +geom_point(aes(color=YEAR), alpha=.8) +facet_wrap(~race_new + male, ncol =2) +coord_flip() +
labs(x = "Age Group", y = "Murders per 100,000")
national
ggsave(file = "national.png", national, height = 8, width=6.5)
homicide_nat %>%
group_by(YEAR) %>%
summarise(sum(PERWT.sum)) #checking if pop total accurate ~less due to dropping few states
nat_comparison <- homicide_nat %>%
select(YEAR, murder_rate, murder.sum, race_new,age_group, male) %>%
group_by(race_new,age_group) %>%
pivot_wider(names_from = "YEAR",
values_from = c(murder_rate,murder.sum))  %>%
ungroup()
skim(nat_comparison)
nat_comparison <- nat_comparison %>%
mutate_at(vars(murder_rate_2019,murder_rate_2020), funs(round(.,2))) %>%
mutate(change = murder_rate_2020 - murder_rate_2019,
total_change = murder.sum_2019 - murder.sum_2020)
dplot_national <- nat_comparison %>%
ggplot(aes(x=`age_group`, y=change, label=change)) +
geom_bar(stat='identity', aes(fill=race_new), position = "dodge")  +
xlab("Age Group") +
ylab("Change in Murders per 100K, 2019 to 2020") +
scale_fill_brewer(palette = "Set1") +
labs(subtitle="By Age Group-Gender-Race",
title= "National Change in Murders per 100K Residents, 2019 to 2020") +
guides(fill=guide_legend(title = "Race")) +
facet_wrap(~ male, ncol = 2) +
coord_flip()
dplot_national
ggsave(file = "dplot_national.png", dplot_national, height = 11, width=8.5)
hom_state <- read_rds("hom_state.rds")
hom_state <- rename(hom_state, murder_state = murder.sum)
hom_state <- rename(hom_state, PERWT_state = PERWT.sum)
hom_state$YEAR <- factor(hom_state$YEAR)
hom_state <- hom_state %>%
mutate(State= to_title_case(state))
hom_state_final <- full_join(summary_final, hom_state, by = c("YEAR","STATEFIP"))
skim(hom_state_final)
library(geofacet)
library(ggridges)
map <- hom_state_final %>%
filter(!is.na(murder.sum))
my_map_data <- us_state_grid2[c(-1,-9,-38),]
map2 <- map %>%
filter(YEAR == 2020) %>%
select(YEAR,State,race_new,age_group,murder.sum) %>%
ggplot(aes(x=`age_group`, y=murder.sum, label=murder.sum)) +
geom_bar(stat='identity', aes(fill=race_new), position = "dodge") +
facet_geo(~ State,  grid = my_map_data) +
scale_fill_brewer(palette = "Set1") +
labs(title = "Total Homicides 2020",
fill = "Race",
x = NULL,
y = "Total Homicides") +
# guides(fill = guide_legend(
#   title.position = "top",
#   label.position = "bottom",
#   nrow = 1
# )) +
theme_minimal() +
theme(
legend.pos = "top",
legend.spacing.x = unit(1, "lines"),
legend.direction = "horizontal",
legend.box ="vertical",
legend.title= element_blank(),
plot.margin = margin(0.5, 0.5, 0.5, 0.5, "cm"),
plot.background = element_rect(fill = "white"),
plot.title = element_text(face = "bold",
size = 22),
axis.text.x = element_text(
angle = -90,
size = 5,
face = "bold",
vjust = 0,
hjust = 0
),
axis.text.y = element_text(face = "bold", hjust = 0.5, size = 6),
#legend.title = element_text(size = 8),
#legend.text = element_text(size = 7),
#legend.position = "top",
#legend.spacing.x = unit(1, "lines"),
#legend.direction = "horizontal",
panel.grid.major.x = element_line(size = 0.2),
panel.grid.major.y = element_line(size = 0.2))
ggsave(file = "2020_murders.png",map2, width = 20, height =10)
map2
map1 <- map %>%
filter(YEAR == 2020 & murder_rate<400) %>%
select(YEAR,State,race_new,age_group,murder_rate) %>%
ggplot(aes(x=`age_group`, y=murder_rate, label=murder_rate)) +
geom_bar(stat='identity', aes(fill=race_new), position = "dodge") +
facet_geo(~ State,  grid = my_map_data) +
scale_fill_brewer(palette = "Set1") +
labs(title = "Total Homicides 2020",
fill = "Race",
x = NULL,
y = "Total Homicides") +
# guides(fill = guide_legend(
#   title.position = "top",
#   label.position = "bottom",
#   nrow = 1
# )) +
theme_minimal() +
theme(
legend.pos = "top",
legend.spacing.x = unit(1, "lines"),
legend.direction = "horizontal",
legend.box ="vertical",
legend.title= element_blank(),
plot.margin = margin(0.5, 0.5, 0.5, 0.5, "cm"),
plot.background = element_rect(fill = "white"),
plot.title = element_text(face = "bold",
size = 22),
axis.text.x = element_text(
angle = -90,
size = 5,
face = "bold",
vjust = 0,
hjust = 0
),
axis.text.y = element_text(face = "bold", hjust = 0.5, size = 6),
#legend.title = element_text(size = 8),
#legend.text = element_text(size = 7),
#legend.position = "top",
#legend.spacing.x = unit(1, "lines"),
#legend.direction = "horizontal",
panel.grid.major.x = element_line(size = 0.2),
panel.grid.major.y = element_line(size = 0.2))
ggsave(file = "2020_rate.png",map1, width = 20, height =10)
map1
select_map_data <- us_state_grid2[c(5,13,18,32,43),]
map3 <- map %>%
filter(YEAR == 2020 ) %>%
select(YEAR,State,race_new,age_group,murder_rate) %>%
ggplot(aes(x=`age_group`, y=murder_rate, label=murder_rate)) +
geom_bar(stat='identity', aes(fill=race_new), position = "dodge") +
facet_geo(~ State,  grid = select_map_data) +
scale_fill_brewer(palette = "Set1") +
labs(title = "Total Homicides 2020",
fill = "Race",
x = NULL,
y = "Total Homicides") +
# guides(fill = guide_legend(
#   title.position = "top",
#   label.position = "bottom",
#   nrow = 1
# )) +
theme_minimal() +
theme(
legend.pos = "top",
legend.spacing.x = unit(1, "lines"),
legend.direction = "horizontal",
legend.box ="vertical",
legend.title= element_blank(),
plot.margin = margin(0.5, 0.5, 0.5, 0.5, "cm"),
plot.background = element_rect(fill = "white"),
plot.title = element_text(face = "bold",
size = 22),
axis.text.x = element_text(
angle = -90,
size = 5,
face = "bold",
vjust = 0,
hjust = 0
),
axis.text.y = element_text(face = "bold", hjust = 0.5, size = 6),
#legend.title = element_text(size = 8),
#legend.text = element_text(size = 7),
#legend.position = "top",
#legend.spacing.x = unit(1, "lines"),
#legend.direction = "horizontal",
panel.grid.major.x = element_line(size = 0.2),
panel.grid.major.y = element_line(size = 0.2))
ggsave(file = "2020_selected.png",map3, width = 20, height =10)
map3
q()
